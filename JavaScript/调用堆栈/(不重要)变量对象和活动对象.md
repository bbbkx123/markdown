

### VO/AO
接下来要介绍两个概念:

* VO(变量对象), 也就是variable object, 创建执行上下文时与之关联的会有一个变量对象，该上下文中的所有变量和函数全都保存在这个对象中。

* AO(活动对象), 也就是``activation object`,进入到一个执行上下文时，此执行上下文中的变量和函数都可以被访问到，可以理解为被激活了。

活动对象和变量对象的区别在于:

* 变量对象（VO）是规范上或者是JS引擎上实现的，并不能在JS环境中直接访问。
* 当进入到一个执行上下文后，这个变量对象才会被激活，所以叫活动对象（AO），这时候活动对象上的各种属性才能被访问。
上面似乎说的比较难理解😢, 没关系, 我们慢慢来看.

### 执行过程
首先来看看一个**执行上下文(EC)**被创建和执行的过程:

**1.创建阶段:**
* 创建变量、参数、函数arguments对象;

* 建立作用域链;

* 确定this的值.

**2.执行阶段:**
变量赋值, 函数引用, 执行代码.

### 进入执行上下文
在创建阶段, 也就是还没有执行代码之前

此时的变量对象包括(如下顺序初始化):

* 函数的所有形参(仅在函数上下文): 没有实参, 属性值为undefined;
* 函数声明：如果变量对象已经存在相同名称的属性，则完全替换这个属性;
* 变量声明：如果变量名称跟已经声明的形参或函数相同，则变量声明不会干扰已经存在的这类属性
**一起来看下面的例子:**
```js
function fn (a) {
	var b = 2;
	function c () {};
	var d = function {};
	b = 20
}
fn(1)
```
对于上面的例子, 此时的```AO```是:
```js
AO = {
	arguments: {
		0: 1,
		length: 1
	},
	a: 1,
	b: undefined,
	c: reference to function c() {},
	d: undefined
}
```
可以看到, 形参```arguments```此时已经有赋值了, 但是变量还是```undefined```.

### 代码执行
到了代码执行时, 会修改变量对象的值, 执行完后```AO```如下:
```js
AO = {
	arguments: {
		0: 1,
		length: 1
	},
	a: 1,
	b: 20,
	c: reference to function c() {},
	d: reference to function d() {}
}
```
在此阶段, 前面的变量对象中的值就会被赋值了, 此时变量对象处于激活状态.

## 总结
* 全局上下文的变量对象初始化是全局对象, 而函数上下文的变量对象初始化只有Arguments对象;

* EC创建阶段分为创建阶段和代码执行阶段;

* 在进入执行上下文时会给变量对象添加形参、函数声明、变量声明等初始的属性值;

* 在代码执行阶段，会再次修改变量对象的属性值.